<%= render "shared/globalize_locales", resource: @proposal %>

<%= form_for(@quiz, url: form_url) do |f| %>

  <div class="row column quiz-form">
    <div class="small-12 column custom-form">
      <%= f.label :q1, 'Del siguiente listado, selecciona el que crees es el principal problema de derechos humanos para este tema' %><br>
        <% @options.each do |option| %>
          <%= f.radio_button :q1, option, label: nil %><br><br>
        <% end %>
    </div>

    <div class="small-12 column" id="hidden-field" style="display: none;">
      <%= f.text_area :q5,
        rows: 1, maxlength: 500, label: 'Respuesta para "Otro"' %>
      <br/>
    </div>

    <div class="small-12 column">
      <label>Pregunta abierta (Opcional)</label>

      <%= f.text_field :name,
        label: 'Título',
        hint: 'Indica un nombre que sirva para identificar la descripción del problema que abordarás (máximo 80 caracteres)',
        maxlength: 80 %>

      <%= f.text_area :description,
        maxlength: 500,
        label: '¿De qué forma se manifiesta este problema? (casos, ejemplos, situaciones)?',
        hint: '(máximo 500 caracteres)',
        rows: 3 %>
    </div>

    <div class="small-12 column">
      <%= f.label :q3, 'OPCIONAL: ¿Cuál es el alcance geográfico de este problema? (selecciona una de las siguientes opciones)' %><br>
      <%= f.radio_button :q3, 'Afecta a mi comuna o comunidad', label: 'Afecta a mi comuna o comunidad' %><br>
      <%= f.radio_button :q3, 'Afecta a mi región', label: 'Afecta a mi región' %><br>
      <%= f.radio_button :q3, 'Afecta a todo el país', label: 'Afecta a todo el país' %>
      <br/><br/>
    </div>

    <div class="small-12 column">
      <%= f.label :q4, 'OPCIONAL: ¿A qué grupos de población afecta particularmente este problema (selecciona todas las opciones que quieras)?' %><br>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Mujeres' %>
        Mujeres
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Niños, niñas y adolescentes' %>
        Niños, niñas y adolescentes
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Personas con discapacidad' %>
        Personas con discapacidad
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Personas LGBTIQ+' %>
        Personas LGBTIQ+
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Personas mayores' %>
        Personas mayores
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Personas migrantes y refugiadas' %>
        Personas migrantes y refugiadas
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Personas privadas de libertad' %>
        Personas privadas de libertad
      <% end %>
      <%= label_tag nil, style: 'font-weight: normal' do %>
        <%= check_box_tag 'q4[]', 'Pueblos indígenas y tribales' %>
        Pueblos indígenas y tribales
      <% end %>
      <br/>
    </div>

    <%= f.hidden_field :quiz_type, value: 1 %>
    <%= f.hidden_field :tag_id, value: params[:chapter] %>

      <div class="small-12 column">
        <label>¿Quieres que este aporte sea público? Esto permite que sea visible a otras personas en esta plataforma, y que pueda recibir apoyo de ellas</label>
        <%= f.check_box :visible, label: 'Sí, que sea público' %>
      <br/>
      </div>

    <div class="actions small-12 column">
      <%= f.submit(class: "button", value: 'Enviar', data: { disable_with: false }) %>
    </div>
  </div>
<% end %>

<script>
$(document).ready(function() {
  $('#quiz_q1').attr('required', true)

  $('input[name="quiz[q1]"]').on('change', function() {
    if (this.value === 'Otro' || this.value === 'otro') {
      $('#hidden-field').css('display', 'block');
    } else {
      $('#hidden-field').css('display', 'none');
    }
  })

  $('#new_quiz').on('submit', function(e) {
    if ($('input[name="quiz[q1]"]:checked').length <= 0) {
      $('[for="quiz_q1"]').css('color', 'red');
      e.preventDefault();
      window.scrollTo(0, 0);
      return false;
    } else {
      $('[for="quiz_q1"]').css('color', 'black');
    }
  })

  if ($('#quiz_visible').is(':checked')) {
    $('#quiz_name').attr('required', true)
    $('#quiz_description').attr('required', true)
  } else {
    $('#quiz_name').attr('required', false)
    $('#quiz_description').attr('required', false)
  }

  $('#quiz_visible').on('change', function() {
    if ($('#quiz_visible').is(':checked')) {
      $('#quiz_name').attr('required', true)
      $('#quiz_description').attr('required', true)
    } else {
      $('#quiz_name').attr('required', false)
      $('#quiz_description').attr('required', false)
    }
  })
})
</script>