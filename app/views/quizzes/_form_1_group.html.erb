<% @q1_options = [
  'Memoria, verdad, justicia y reparación frente a las violaciones de derechos humanos.',
  'Educación para una sociedad sin discriminación',
  'Salud y bienestar físico, mental y social de las personas',
  'Acceso al agua',
  'Trabajo digno y derechos de las y los trabajadores',
  'Vivienda para vivir con seguridad, paz y dignidad',
  'Pensiones dignas y apoyo económico frente a la necesidad',
  'Alimentación para una vida sana y protección contra el hambre',
  'Valoración de la diversidad cultural y acceso a la cultura',
  'Protección del medio ambiente para la sostenibilidad de la vida en el planeta',
  'Prevención de la tortura y de la violencia institucional',
  'Datos protegidos y uso seguro del internet',
  'Acceso a la justicia',
  'Educación en derechos humanos para una sociedad centrada en las personas',
  'Participación',
] %>

<% @q2_options = [
  'Memoria, verdad, justicia y reparación frente a las violaciones de derechos humanos.',
  'Educación para una sociedad sin discriminación',
  'Salud y bienestar físico, mental y social de las personas',
  'Acceso al agua',
  'Trabajo digno y derechos de las y los trabajadores',
  'Vivienda para vivir con seguridad, paz y dignidad',
  'Pensiones dignas y apoyo económico frente a la necesidad',
  'Alimentación para una vida sana y protección contra el hambre',
  'Valoración de la diversidad cultural y acceso a la cultura',
  'Protección del medio ambiente para la sostenibilidad de la vida en el planeta',
  'Prevención de la tortura y de la violencia institucional',
  'Datos protegidos y uso seguro del internet',
  'Acceso a la justicia',
  'Educación en derechos humanos para una sociedad centrada en las personas',
  'Participación',
] %>

<% @q6_options = [
  'Personas Mayores',
  'Mujeres',
  'LGBTIQ+',
  'Personas con Discapacidad',
  'Pueblos Indígenas y Tribales',
  'Personas Privadas de Libertad',
  'Personas Migrantes y Refugiadas',
  'Niños, niñas y adolescentes',
]%>

<% @q6_options = [
  'En casa de mi familia o personas cercanas',
  'En mi barrio',
  'En mi escuela',
  'En mi comuna',
  'En mi región',
  'En todo el país',
]%>


<%= form_for(@quiz, url: form_url) do |f| %>
  <div class="row column quiz-form">

    <div class="small-12 column">
      <label for="q1">1. ¿En cuál de estos temas creen que se respetan menos los derechos humanos de las personas?</label>
      <div><br/>
      <% @q1_options.each do |option| %>
        <%= option %>: <%= number_field_tag 'q1_%s' % [option], 0, class: 'number-selection', min: 0, oninput: "this.value=this.value.replace(/[^0-9]/g,'');" %><br/>
      <% end %>
      </div>
      <br/><br/>
    </div>

    <div class="small-12 column">
      <label for="q2">2. A continuación, seleccionen el tema que escogió el grupo como aquel en que <u>menos se respetan</u> los derechos humanos.</label>
      <span class="help-text">Pueden escoger el que obtuvo más votos u otro que el grupo acordó.</span>
        <%= select_tag 'q2', options_for_select(@q2_options), prompt: 'Elijan una opción' %>
      <br/><br/>
    </div>

    <div class="small-12 column">
      <label for="q3">3. En aquel tema en que se respetan menos los derechos humanos<span id="custom-option" display="none"></span>, ¿En qué nota el grupo que no se respetan y qué problema identifican? </label>
      <p id="text-after-q2"></p>
      <small>(Limite: 1000 caracteres)</small>
      <% if params[:quiz_id].present? %>
        <%= text_area_tag 'q3', Quiz.find(params[:quiz_id]).q1.nil? ? '' : eval(Quiz.find(params[:quiz_id]).q1).fetch('q3', ''), rows: 4, maxlength: 1000 %>
      <% else %>
        <%= text_area_tag 'q3', nil, rows: 4, maxlength: 1000 %>
      <% end %>
      <br/>
    </div>

    <div class="small-12 column">
      <label for="q4">4. ¿Cuál o cuáles creen que son las <u>causas</u> de ese problema?</label>
      <p>Este problema se produce por:</p>
      <small>(Limite: 1000 caracteres)</small>
      <% if params[:quiz_id].present? %>
        <%= text_area_tag 'q4', Quiz.find(params[:quiz_id]).q1.nil? ? '' : eval(Quiz.find(params[:quiz_id]).q1).fetch('q4', ''), rows: 4, maxlength: 1000 %>
      <% else %>
        <%= text_area_tag 'q4', nil, rows: 4, maxlength: 1000 %>
      <% end %>
      <br/>
    </div>

    <div class="small-12 column">
      <label for="q5">5. ¿Qué efectos tiene en las personas?</label>
      <p>Este problema provoca:</p>
      <small>(Limite: 1000 caracteres)</small>
      <% if params[:quiz_id].present? %>
        <%= text_area_tag 'q5', Quiz.find(params[:quiz_id]).q1.nil? ? '' : eval(Quiz.find(params[:quiz_id]).q1).fetch('q5', ''), rows: 4, maxlength: 1000 %>
      <% else %>
        <%= text_area_tag 'q5', nil, rows: 4, maxlength: 1000 %>
      <% end %>
      <br/><br/>
    </div>

    <div class="small-12 column">
      <label for="q6">6. ¿A quienes creen que afecta este problema?</label>
      <small class="help-text">Marquen todas las casillas que crean necesario</small>
      <div>
      <% @q6_options.each do |option| %>
        <%= option %>: <%= number_field_tag 'q6_%s' % [option], 0, class: 'number-selection', min: 0, oninput: "this.value=this.value.replace(/[^0-9]/g,'');"  %><br/>
      <% end %>
      </div>
      <br/>
    </div>

    <div class="small-12 column">
      <label for="q7">7. ¿En qué lugares crees que se vive este problema?</label>
      <small class="help-text">Marquen todas las casillas que crean necesario</small>
      <div>
      <% @q6_options.each do |option| %>
        <%= option %>: <%= number_field_tag 'q7_%s' % [option], 0, class: 'number-selection', min: 0, oninput: "this.value=this.value.replace(/[^0-9]/g,'');"  %><br/>
      <% end %>
      </div>
      <br/><br/>
    </div>

    <% @current_quiz = Quiz.create(name: 'TMP', user_id: current_user.id, visible: false) %>

    <input type="hidden" id="quiz_id" name="quiz_id" value="<%= @current_quiz.id %>">
    <input type="hidden" id="step" name="step" value="1">
    <input type="hidden" id="type" name="type" value="<%= params[:type].present? ? params[:type] : '' %>">
    <input type="hidden" id="group" name="group" value="<%= params[:group].present? ? params[:group] : '' %>">

    <div class="actions small-12 column">
      <button id="submit" type="submit" class="button">Continuar</button>
    </div>
  </div>
<% end %>

<script>
$(document).ready(function() {
  $('#text-after-q2').text('El problema que identificamos es:')

  $('#q2').on('change', function() {
    $('#custom-option').text($('#q2').val() ? ` ${$('#q2').val()}` : '')
  })
})
</script>